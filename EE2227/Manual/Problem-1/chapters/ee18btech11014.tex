\begin{enumerate}[label=\thesubsection.\arabic*.,ref=\thesubsection.\theenumi]
\numberwithin{equation}{enumi}
%2.1.1
\item Consider the Magnitude Bode Plot and Phase Bode Plot \ref{fig:Bode} of Open-Loop Transfer Function of an Amplifier. Estimate the Open-Loop Transfer Function. (Assume $'A'$ as $'G'$ and $'\beta'$ as $'H'$)
\begin{figure}[ht!]
	\begin{center}
		\includegraphics[width=\columnwidth]{./figs/ee18btech11014/ee18btech11014_figa.eps}
	\end{center}
	\caption{Magnitude and Phase Bode Plot}
	\label{fig:Bode}
\end{figure}\\
\solution Let $G(f)$ be the Open-Loop Transfer Function,
\begin{align}
G(f) = 
\begin{cases} 
      100 & 0 < f < 10^{5} \\
      200-20log(f) & 10^{5} < f < 10^{6} \\
      320-40log(f) & 10^{6} < f < 10^{7} \\
      460-60log(f) & 10^{7} < f  \\
\end{cases}
\end{align}

\begin{align}
\nabla G(f) &= \dfrac{d(G(f))}{d(log(f))} =
\begin{cases} 
        0 & 0 < f < 10^{5} \\
      -20 & 10^{5} < f < 10^{6} \\
      -40 & 10^{6} < f < 10^{7} \\
      -60 & 10^{7} < f  \\ 
\end{cases}
\end{align}

As we know that, \textbf{When a pole is encountered the slope always decreases by 20 dB/decade} and \textbf{When a zero is encountered the slope always increases by 20 dB/decade}. So, by observing \ref{fig:Bode} it can be concluded that we are having Poles at $f=10^{5} Hz, 10^{6} Hz, 10^{7} Hz$ and No Zeros.\\

So, the Open-Loop Transfer Function $G(f)$ is
\begin{align}
	G(f) = \dfrac{10^{5}}{\left(1+j\frac{f}{10^{5}}\right)\left(1+j\frac{f}{10^{6}}\right)\left(1+j\frac{f}{10^{7}}\right)}
\end{align}\\
%-------------------------------------------------------------------------------------------------%
%2.1.2
\item Calculate the Phase of Open-Loop Transfer Function.\\
\solution\\
Phase of Open-Loop Transfer Function = $\phi$
\begin{align}
\phi=-\left[\tan ^{-1}\left(f / 10^{5}\right)+\tan ^{-1}\left(f / 10^{6}\right)+\tan ^{-1}\left(f / 10^{7}\right)\right]
\end{align}
%-------------------------------------------------------------------------------------------------%
%2.1.3
\item Determine the Closed-Loop Voltage Gain of the System assuming $|GH|\gg1$ and also assuming the block diagram of Control System is \ref{fig:Control}
\begin{figure}[ht!]
	\begin{center}
		\resizebox{\columnwidth/1}{!}{\input{./figs/ee18btech11014/ee18btech11014_figb.tex}}
	\end{center}
	\caption{}
	\label{fig:Control}
\end{figure}

\solution\\
The Closed-Loop Voltage Gain of the Control System is\\
\begin{align}
T = \frac{V_{o}}{V_{s}} = \frac{G}{1+GH}
\end{align}

\begin{align}
20\log(T) = 20\log(G) - 20\log(1+GH)
\end{align}

Considering the assumption $|GH| \gg 1$, It can be written as
\begin{align}
20\log(1+GH) = 20\log(GH)
\end{align}

So,
\begin{align}
20\log(T) = 20\log(G) - 20\log(GH) \\
20\log(T) = -20\log(H) \\
20\log(T)= 20\log(\frac{1}{H})\\
T = \frac{1}{H}
\end{align}

So, The value of Closed-Loop Voltage Gain of the Control System under the assumption, $|GH| \gg 1$ is $T = \frac{1}{H}$\\
%-------------------------------------------------------------------------------------------------%
%2.1.4
\item What is the value of Loop-Gain?\\
\solution\\
The value of Loop-Gain can be calculated by the difference of 2-curves $20\log|A|$ and $20log(\frac{1}{H})$. The difference between the two curves will be
\begin{align}
20 \log |G|-20 \log \frac{1}{H}=20 \log |GH|
\end{align}
%-------------------------------------------------------------------------------------------------%
%2.1.5
\item Define Phase-Margin\\
\solution\\
\textbf{Phase-Margin:} The phase margin is defined as the angle in degrees by which the phase angle is smaller than $-180^{\circ}$ at the gain crossover, the gain crossover being the frequency at which the open-loop gain first reaches 1. \\
%-------------------------------------------------------------------------------------------------%
%2.1.6
\item Find the frequencies for which phase margins are $90^{\circ}$ and $45^{\circ}$ respectively?\\
\solution\\
Let Phase Margin be $\alpha = 90^{\circ}$. Then,
\begin{align}
\alpha = \phi - (-180^{\circ})\\
\phi = -180^{\circ} + \alpha\\
\phi = -90^{\circ}
\end{align}

So, by the definition of Phase-Margin, at $\phi = -90^{\circ}$ , $|GH| = 1 $.  The value of $\phi = -90^{\circ}$ between poles $f=10^{5}Hz,10^{6}Hz$. Assuming the Poles are farther apart, 
\begin{align}
\tan^{-1}(\frac{f}{10^{7}}) \approx 0
\end{align}
where $10^{5} < f < 10^{6}$

So,
\begin{align}
-\tan^{-1}\left(f/10^{5}\right)-\tan^{-1}\left(f/10^{6}\right) = -90\\
\tan^{-1}\left(f/10^{5}\right)+\tan^{-1}\left(f/10^{6}\right) = 90\\
\tan^{-1}\left(f/10^{5}\right) = 90-\tan^{-1}\left(f/10^{6}\right)\\
\tan^{-1}\left(f/10^{5}\right) = \cot^{-1}\left(f/10^{6}\right)\\
\tan^{-1}\left(f/10^{5}\right) = \tan^{-1}\left(10^{6}/f\right)\\
f^{2} = 10^{11}\\
f = 3.162 \times 10^{5}
\end{align}

So, the approximate value of $f$ at which Phase Margin is $90^{\circ}$ is $f=3.162 \times 10^{5} Hz$.\\

Similarly let Phase Margin be $\alpha = 45^{\circ}$. Then,
\begin{align}
\alpha = \phi - (-180^{\circ})\\
\phi = -180^{\circ} + \alpha\\
\phi = -135^{\circ}
\end{align}

So, by the definition of Phase-Margin, at $\phi = -135^{\circ}$ , $|GH| = 1 $.  The value of $\phi = -135^{\circ}$ aproximately at poles $f=10^{6} Hz$. 

So, the approximate value of $f$ at which Phase Margin is $45^{\circ}$ is $f=10^{6}$.\\
%-------------------------------------------------------------------------------------------------%
%2.1.7
\item Find the minimum values of Closed-Loop Voltage Gain for which phase margins are $90^{\circ}$ and  $45^{\circ}$ respectively\\
\solution\\
For $\alpha=90^{\circ}$,
\begin{align}
f=3.162 \times 10^{5}
\end{align}
By substituting $f$ in Open-Loop Gain $G(f)$ (assuming poles are far part), 
\begin{align}
G(f) = 200 - 20log(3.162 \times 10^{5})\\
G(f) = 90 dB \\
G = 3.1625 \times 10^{4}
\end{align}

At that $f=3.162 \times 10^{5}$, 
\begin{align}
H = \frac{1}{G}\\
H = 3.162 \times 10^{-5}
\end{align}

The minimum value of Closed-Loop Gain occurs at $|GH| \gg 1$ and the value of Closed-Loop Gain is $T=\frac{1}{H}$

\begin{align}
T = \frac{1}{H} = 3.1625 \times 10^{4}
\end{align}

\textbf{So, The minimum value of Closed-Loop Gain with Phase Margin equal to $\alpha=90^{\circ}$ is $T_{min} = 3.1625 \times 10^{4}$.}\\

For $\alpha=45^{\circ}$,
\begin{align}
f=10^{6}
\end{align}
By substituting $f$ in Open-Loop Gain $G(f)$ (assuming poles are far part), 
\begin{align}
G(f) = 200 - 20log(10^{6})\\
G(f) = 80 dB \\
G = 10^{4}
\end{align}

At that $f = 10^{6}$, 
\begin{align}
H = \frac{1}{G}\\
H = 10^{-4}
\end{align}

The minimum value of Closed-Loop Gain occurs at $|GH| \gg 1$ and the value of Closed-Loop Gain is $T=\frac{1}{H}$

\begin{align}
T = \frac{1}{H} = 10^{4}
\end{align}

\textbf{So, The minimum value of Closed-Loop Gain with Phase Margin equal to $\alpha=45^{\circ}$ is $T_{min} = 10^{4}$.}\\
%-------------------------------------------------------------------------------------------------%
%2.1.8
\item Break the Transfer Function $G(f)$ into Simple Blocks and Create a Block Diagram for $G(f)$.\\
\solution\\
\begin{figure}[ht!]
	\begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11014/ee18btech11014_figh.tex}}
	\end{center}
	\caption{}
	\label{fig:RC Circuit}
\end{figure}

%-------------------------------------------------------------------------------------------------%
%2.1.9
\item Find the Gain of RC-Circuit shown below \ref{fig:RC Circuit} and also identify the location of Poles.
\begin{figure}[ht!]
	\begin{center}
		\resizebox{\columnwidth/2}{!}{\input{./figs/ee18btech11014/ee18btech11014_figf.tex}}
	\end{center}
	\caption{}
	\label{fig:RC Circuit}
\end{figure}

\solution
\begin{align}
I = \frac{v_{input}}{R + \frac{1}{Cs}}\\
v_{output} = I \times \frac{1}{Cs}\\
v_{output} = \frac{v_{input} \times \frac{1}{Cs}}{R + \frac{1}{Cs}}\\
\frac{v_{output}}{v_{input}} = \frac{1}{RCs + 1}\\
s = j2\pi f\\
Gain = \frac{v_{output}}{v_{input}} = \frac{1}{j2\pi RCf + 1}
\end{align}

So, there is a Pole at frequency $f = \frac{1}{2\pi RC}$ for the Transfer Function of Gain.\\
%-------------------------------------------------------------------------------------------------%
%2.1.10
\item Find the Gain of Operational Amplifier. The circuit diagram of Equivalent Circuit is \ref{fig:OpAmp Circuit}.
\begin{figure}[ht!]
	\begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11014/ee18btech11014_figg.tex}}
	\end{center}
	\caption{}
	\label{fig:OpAmp Circuit}
\end{figure}

\solution\\
Applying KVL and KCL,
\begin{align}
v_{o} = Gv_{i}
\end{align}

As no current flows through $R_{s}$,
\begin{align}
v_{i} = v_{c} - v_{f}\\
v_{f} = \frac{R_{1}}{R_{1}+R_{2}}v_{o}\\
v_{i} = \frac{v_{o}}{G}\\
\frac{v_{o}}{G} = v_{c} - \frac{R_{1}}{R_{1}+R_{2}}v_{o}\\
\frac{v_{o}}{v_{c}} = \frac{G}{1+G\frac{R_{1}}{R_{1}+R_{2}}}
\end{align}

So, Gain of the Circuit is $\frac{G}{1+G\frac{R_{1}}{R_{1}+R_{2}}}$
%-------------------------------------------------------------------------------------------------%
%2.1.11
\item Design a Circuit Model that follows the Transfer Function $G(f)$\\
\solution\\
Our Design for Modelling the Transfer Function is based on Poles of RC-Circuit and Gain of Operational Amplifier.\\

So, the Circuit Diagram is,
\begin{figure}[ht!]
	\begin{center}
		\resizebox{\columnwidth/1}{!}{\input{./figs/ee18btech11014/ee18btech11014_figc.tex}}
	\end{center}
	\caption{}
	\label{fig:Open-Loop Circuit}
\end{figure}
 
Assuming, Open-Loop Gain of Operational Amplifier is $10^{5}$ and also assuming Operational Amplifier doesnt have any Poles.\\
Equivalent Circuit of the circuit is
\begin{figure}[ht!]
	\begin{center}
		\resizebox{\columnwidth/1}{!}{\input{./figs/ee18btech11014/ee18btech11014_figd.tex}}
	\end{center}
	\caption{}
	\label{fig:Equivalent Open-Loop Circuit}
\end{figure}

The cascade of RC Circuits are used to introduce poles in the circuit and Op-Amp are used to achieve the Gain required.\\

At the First Operational Amplifier,
\begin{align}
v_{i} = v_{s}\\
v_{a} = 10^3 v_{i}\\
v_{a} = 10^3 v_{s}
\end{align}

At the first RC-Circuit,
\begin{align}
2\pi RC = 10^{-7}\\
v_{b} = \frac{v_{a}}{1 + j\frac{f}{10^{7}}}\\
v_{b} = \frac{10^3 v_{i}}{1 + j\frac{f}{10^{7}}}
\end{align}

At the Second Operational Amplifier and Second RC-Circuit,
\begin{align}
2\pi RC = 10^{-6}\\
v_{c} = \frac{10v_{b}}{1 + j\frac{f}{10^{6}}}\\
v_{c} = \frac{10^4 v_{i}}{(1 + j\frac{f}{10^{6}})(1 + j\frac{f}{10^{7}})}
\end{align}

At the Third Operational Amplifier and Third RC-Circuit,
\begin{align}
2\pi RC = 10^{-5}\\
v_{o} = \frac{10v_{c}}{1 + j\frac{f}{10^{5}}}
\end{align}
\begin{align}
v_{o} = \frac{10^5 v_{i}}{(1 + j\frac{f}{10^{5}})(1 + j\frac{f}{10^{6}})(1 + j\frac{f}{10^{7}})}
\end{align}

The RC Circuits introduces poles at $f=10^{7} Hz, 10^{6} Hz, 10^{5} Hz$ respectively from left to right. The Op-Amps introduce a gain  $10^{3},10,10$. THe second and third Op-Amps act as a buffer. So, the value of $v_{o}$ is

\begin{align}
v_{o} = \dfrac{10^5 v_{i}}{\left(1+j\frac{f}{10^{5}}\right)\left(1+j\frac{f}{10^{6}}\right)\left(1+j\frac{f}{10^{7}}\right)}
\end{align}

So, Open-Loop Gain is
\begin{align}
G = \dfrac{10^5}{\left(1+j\frac{f}{10^{5}}\right)\left(1+j\frac{f}{10^{6}}\right)\left(1+j\frac{f}{10^{7}}\right)}
\end{align}

%-------------------------------------------------------------------------------------------------%
%2.1.12
\item Design a Circuit Model that follows the Feedback Transfer Function $H(f)$\\
\solution\\
On Bode Plot is $H$ is independent of frequency. So, $H$  should not involve any Reactive Elements. So, $H$ is a combination of Resistors or a Voltage Divider.
\begin{figure}[ht!]
	\begin{center}
		\resizebox{\columnwidth/2}{!}{\input{./figs/ee18btech11014/ee18btech11014_fige.tex}}
	\end{center}
	\caption{}
	\label{fig:Feedback Circuit}
\end{figure}

\begin{align}
v_{f} = \frac{10}{10 + 10^{5}} \times v_{o}\\
v_{f} \approx 10^{-4} v_{o}\\
\frac{v_{f}}{v_{o}} \approx 10^{-4}\\
H(f) = 10^{-4}
\end{align}

%-------------------------------------------------------------------------------------------------%
%2.1.13
\item  Design a Closed-Loop Transfer Function by combining both the Open-Loop and Feedback Circuits. Also draw its Equivalent Circuit\\
\solution\\
The Closed-Loop Circuit is
\begin{figure}[ht!]
	\begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11014/ee18btech11014_figi.tex}}
	\end{center}
	\caption{}
	\label{fig:Closed-Loop Circuit}
\end{figure}

The Equivalent Circuit of Closed-Loop Circuit is
\begin{figure}[ht!]
	\begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11014/ee18btech11014_figj.tex}}
	\end{center},
	\caption{}
	\label{fig:Closed-Loop Equivalent Circuit}
\end{figure}

From the Equivalent Circuit Diagram,
\begin{align}
G = \frac{v_{o}}{v_{i}} = \dfrac{10^5}{\left(1+j\frac{f}{10^{5}}\right)\left(1+j\frac{f}{10^{6}}\right)\left(1+j\frac{f}{10^{7}}\right)}\\
H = \frac{v_{f}}{v_{o}} = 10^{-4}
\end{align}

The Closed-Loop Gain,
\begin{align}
v_{i} = v_{s} - v_{f}\\
\frac{v_{o}}{G} = v_{s} - Hv_{o}\\
\frac{v_{o}}{v_{s}} = \frac{G}{1+GH}
\end{align}

So, the Closed-Loop Gain,
\begin{align}
T = \frac{v_{o}}{v_{s}} = \dfrac{10^5}{10 + \left(1+j\frac{f}{10^{5}}\right)\left(1+j\frac{f}{10^{6}}\right)\left(1+j\frac{f}{10^{7}}\right)}
\end{align}

\end{enumerate}
